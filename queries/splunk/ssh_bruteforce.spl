index=* ("Failed password" OR "Accepted password")
| rex "for (?:invalid user )?(?<user>\S+) from (?<src_ip>\d+\.\d+\.\d+\.\d+)"
| eval outcome=if(match(_raw,"Accepted password"),"success","failure")
| bucket _time span=10m
| stats count(eval(outcome="failure")) as failures, count(eval(outcome="success")) as successes by src_ip
| where failures>=10 AND successes>=1
| sort -count
